<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç ‚Äî Beauty Studio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
  <link rel="stylesheet" href="/style.css" />
  <style>
    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 24px;
      border-bottom: 2px solid #e5e7eb;
      padding-bottom: 0;
    }
    
    .tab {
      padding: 12px 24px;
      background: transparent;
      border: none;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      font-size: 1rem;
      color: #6b7280;
      transition: all 0.2s;
      position: relative;
      bottom: -2px;
    }
    
    .tab:hover {
      color: #a855f7;
      background: rgba(168, 85, 247, 0.05);
    }
    
    .tab.active {
      color: #a855f7;
      border-bottom-color: #a855f7;
      font-weight: 600;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .booking-card {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
      transition: all 0.2s;
    }
    
    .booking-card:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transform: translateY(-2px);
    }
    
    .booking-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
    }
    
    .booking-service {
      font-size: 1.2rem;
      font-weight: 600;
      color: #1f2937;
      margin-bottom: 8px;
    }
    
    .booking-date-time {
      color: #6b7280;
      font-size: 0.95rem;
    }
    
    .booking-salon {
      color: #a855f7;
      font-weight: 500;
      margin-top: 8px;
    }
    
    .booking-master {
      color: #6b7280;
      font-size: 0.9rem;
      margin-top: 4px;
    }
    
    .booking-status {
      padding: 4px 12px;
      border-radius: 999px;
      font-size: 0.85rem;
      font-weight: 500;
    }
    
    .booking-status.active {
      background: #dcfce7;
      color: #166534;
    }
    
    .booking-status.past {
      background: #f3f4f6;
      color: #6b7280;
    }
    
    .salon-card {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .salon-card:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transform: translateY(-2px);
      border-color: #a855f7;
    }
    
    .salon-name {
      font-size: 1.2rem;
      font-weight: 600;
      color: #1f2937;
      margin-bottom: 8px;
    }
    
    .salon-address {
      color: #6b7280;
      font-size: 0.95rem;
      margin-bottom: 8px;
    }
    
    .salon-phone {
      color: #a855f7;
      font-size: 0.9rem;
      margin-top: 8px;
    }
    
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #6b7280;
    }
    
    .empty-state-icon {
      font-size: 4rem;
      margin-bottom: 16px;
      opacity: 0.5;
    }
    
    .phone-input-section {
      background: white;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
      border: 1px solid #e5e7eb;
    }
    
    .phone-input-section h3 {
      margin-bottom: 16px;
      color: #1f2937;
    }
    
    .phone-input-group {
      display: flex;
      gap: 12px;
    }
    
    .phone-input-group input {
      flex: 1;
      padding: 12px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-size: 1rem;
    }
    
    .phone-input-group button {
      padding: 12px 24px;
      white-space: nowrap;
    }
    
    @media (max-width: 768px) {
      .tabs {
        flex-wrap: wrap;
      }
      
      .tab {
        padding: 10px 16px;
        font-size: 0.9rem;
      }
      
      .booking-header {
        flex-direction: column;
        gap: 8px;
      }
      
      .phone-input-group {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
<header>
  <a href="/" class="home-link" title="–ù–∞ –≥–ª–∞–≤–Ω—É—é" id="home-link-header">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
      <polyline points="9 22 9 12 15 12 15 22"></polyline>
    </svg>
    –ì–ª–∞–≤–Ω–∞—è
  </a>
  <h1>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h1>
  <p id="client-greeting">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞—à–∏–º–∏ –∑–∞–ø–∏—Å—è–º–∏</p>
  <div class="nav-links">
    <a href="/" id="home-link">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
    <a href="/register-client" id="register-link" style="display: none;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
    <a href="/login-client" id="login-link-nav" style="display: none;">–í—Ö–æ–¥</a>
    <a href="#" id="logout-link" style="display: none;">–í—ã—Ö–æ–¥</a>
  </div>
</header>

<div class="container">
  <div class="breadcrumbs" id="client-breadcrumbs">
    <a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
    <span class="separator">/</span>
    <span class="current">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞</span>
  </div>
  
  <!-- –ö–Ω–æ–ø–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏/–≤—Ö–æ–¥–∞ (–ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω) -->
  <div class="phone-input-section" id="phone-input-section" style="text-align: center;">
    <h3>–í–æ–π–¥–∏—Ç–µ –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</h3>
    <p class="description" style="margin-bottom: 24px;">–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–∞—à–∏—Ö –∑–∞–ø–∏—Å–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</p>
    <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
      <button type="button" class="btn-primary" id="open-cabinet-register-modal" style="padding: 16px 32px; font-size: 1rem;">
        üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
      </button>
      <button type="button" class="btn-secondary" id="open-cabinet-login-modal" style="padding: 16px 32px; font-size: 1rem;">
        üîê –í—Ö–æ–¥
      </button>
    </div>
    <p class="note" style="margin-top: 16px;">
      –ò–ª–∏ <button type="button" id="load-bookings-by-phone-btn" style="background: none; border: none; color: #a855f7; text-decoration: underline; cursor: pointer; padding: 0;">–≤–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞</button> –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–ø–∏—Å–µ–π –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
    </p>
    <!-- –°–∫—Ä—ã—Ç–∞—è —Ñ–æ—Ä–º–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ -->
    <div id="phone-input-form" style="display: none; margin-top: 24px;">
      <div class="phone-input-group">
        <input type="tel" id="client-phone-input" placeholder="+998XX XXX XX XX" />
        <button type="button" class="btn-primary" id="load-bookings-btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–ø–∏—Å–∏</button>
      </div>
      <div id="phone-error" class="alert alert-error" style="display: none; margin-top: 12px;"></div>
    </div>
  </div>

  <!-- –í–∫–ª–∞–¥–∫–∏ -->
  <div class="tabs">
    <button class="tab active" data-tab="bookings">–ú–æ–∏ –∑–∞–ø–∏—Å–∏</button>
    <button class="tab" data-tab="salons">–í—ã–±–æ—Ä —Å–∞–ª–æ–Ω–∞</button>
  </div>

  <!-- –í–∫–ª–∞–¥–∫–∞ —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏ -->
  <div class="tab-content active" id="tab-bookings">
    <div class="card">
      <h2>–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø–∏—Å–∏</h2>
      <p class="description">–í–∞—à–∏ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –∏ –ø—Ä–æ—à–µ–¥—à–∏–µ –∑–∞–ø–∏—Å–∏ –≤ —Å–∞–ª–æ–Ω–∞—Ö –∫—Ä–∞—Å–æ—Ç—ã.</p>
      <div id="bookings-list">
        <div class="empty-state">
          <div class="empty-state-icon">üìÖ</div>
          <p>–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤–∞—à–∏ –∑–∞–ø–∏—Å–∏</p>
        </div>
      </div>
    </div>
  </div>

  <!-- –í–∫–ª–∞–¥–∫–∞ —Å –≤—ã–±–æ—Ä–æ–º —Å–∞–ª–æ–Ω–æ–≤ -->
  <div class="tab-content" id="tab-salons">
    <div class="card">
      <h2>–í—ã–±–æ—Ä —Å–∞–ª–æ–Ω–∞</h2>
      <p class="description">–í—ã–±–µ—Ä–∏—Ç–µ —Å–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã –¥–ª—è –∑–∞–ø–∏—Å–∏.</p>
      <div id="salons-list">
        <div class="empty-state">
          <div class="empty-state-icon">üíá</div>
          <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Å–∞–ª–æ–Ω–æ–≤...</p>
        </div>
      </div>
    </div>
  </div>
</div>

<footer>
  ¬© 2025 Beauty Studio. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
</footer>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
<div id="register-modal" class="modal-overlay hidden">
  <div class="modal" style="max-width: 500px;">
    <div class="modal-header">
      <div class="modal-title">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
      <button type="button" class="modal-close" id="close-register-modal">√ó</button>
    </div>
    <div class="modal-body">
      <!-- –í—ã–±–æ—Ä —Ç–∏–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
      <div id="register-type-selection">
        <p class="description" style="margin-bottom: 16px;">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∞–∫–∫–∞—É–Ω—Ç–∞:</p>
        <div style="display: grid; gap: 12px;">
          <button type="button" class="btn-secondary register-type-btn" data-type="client" style="text-align: left; padding: 16px;">
            <div style="font-weight: 600; margin-bottom: 4px;">üë§ –ö–ª–∏–µ–Ω—Ç</div>
            <div style="font-size: 0.85rem; color: #6b7280;">–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∏—Å–µ–π –∏ –∑–∞–ø–∏—Å—å –≤ —Å–∞–ª–æ–Ω—ã</div>
          </button>
          <button type="button" class="btn-secondary register-type-btn" data-type="master" style="text-align: left; padding: 16px;">
            <div style="font-weight: 600; margin-bottom: 4px;">‚úÇÔ∏è –ú–∞—Å—Ç–µ—Ä</div>
            <div style="font-size: 0.85rem; color: #6b7280;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–∏–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º</div>
          </button>
          <button type="button" class="btn-secondary register-type-btn" data-type="salon" style="text-align: left; padding: 16px;">
            <div style="font-weight: 600; margin-bottom: 4px;">üè¢ –°–∞–ª–æ–Ω</div>
            <div style="font-size: 0.85rem; color: #6b7280;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏, –º–∞—Å—Ç–µ—Ä–∞–º–∏ –∏ –∑–∞–ø–∏—Å—è–º–∏</div>
          </button>
        </div>
      </div>

      <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞ -->
      <div id="register-client-form" style="display: none;">
        <button type="button" class="btn-secondary" id="back-register-type" style="margin-bottom: 12px; padding: 8px 16px; font-size: 0.9rem;">‚Üê –ù–∞–∑–∞–¥</button>
        <h3 style="margin-bottom: 16px;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞</h3>
        <form id="register-client-form-submit">
          <div>
            <label for="reg-client-name">–ò–º—è *</label>
            <input type="text" id="reg-client-name" required placeholder="–í–∞—à–µ –∏–º—è" />
          </div>
          <div>
            <label for="reg-client-phone">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
            <input type="tel" id="reg-client-phone" required placeholder="+998XX XXX XX XX" />
          </div>
          <div>
            <label for="reg-client-email">Email (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
            <input type="email" id="reg-client-email" placeholder="your@email.com" />
          </div>
          <div>
            <label for="reg-client-password">–ü–∞—Ä–æ–ª—å (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
            <input type="password" id="reg-client-password" placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤" />
          </div>
          <button type="submit" class="btn-primary" style="width: 100%; margin-top: 8px;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
          <div id="register-client-error" class="alert alert-error" style="display: none; margin-top: 12px;"></div>
        </form>
      </div>

      <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –º–∞—Å—Ç–µ—Ä–∞ -->
      <div id="register-master-form" style="display: none;">
        <button type="button" class="btn-secondary" id="back-register-type-master" style="margin-bottom: 12px; padding: 8px 16px; font-size: 0.9rem;">‚Üê –ù–∞–∑–∞–¥</button>
        <h3 style="margin-bottom: 16px;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–∞—Å—Ç–µ—Ä–∞</h3>
        <p class="note" style="margin-bottom: 16px;">–í—ã –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –º–∞—Å—Ç–µ—Ä–∞</p>
        <a href="/register/master" class="btn-primary" style="width: 100%; text-align: center; text-decoration: none; display: block;">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</a>
      </div>

      <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–∞–ª–æ–Ω–∞ -->
      <div id="register-salon-form" style="display: none;">
        <button type="button" class="btn-secondary" id="back-register-type-salon" style="margin-bottom: 12px; padding: 8px 16px; font-size: 0.9rem;">‚Üê –ù–∞–∑–∞–¥</button>
        <h3 style="margin-bottom: 16px;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–∞–ª–æ–Ω–∞</h3>
        <p class="note" style="margin-bottom: 16px;">–í—ã –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–∞–ª–æ–Ω–∞</p>
        <a href="/register" class="btn-primary" style="width: 100%; text-align: center; text-decoration: none; display: block;">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</a>
      </div>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ -->
<div id="login-modal" class="modal-overlay hidden">
  <div class="modal" style="max-width: 500px;">
    <div class="modal-header">
      <div class="modal-title">–í—Ö–æ–¥</div>
      <button type="button" class="modal-close" id="close-login-modal">√ó</button>
    </div>
    <div class="modal-body">
      <!-- –í—ã–±–æ—Ä —Ç–∏–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
      <div id="login-type-selection">
        <p class="description" style="margin-bottom: 16px;">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∞–∫–∫–∞—É–Ω—Ç–∞:</p>
        <div style="display: grid; gap: 12px;">
          <button type="button" class="btn-secondary login-type-btn" data-type="client" style="text-align: left; padding: 16px;">
            <div style="font-weight: 600; margin-bottom: 4px;">üë§ –ö–ª–∏–µ–Ω—Ç</div>
            <div style="font-size: 0.85rem; color: #6b7280;">–í—Ö–æ–¥ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</div>
          </button>
          <button type="button" class="btn-secondary login-type-btn" data-type="master" style="text-align: left; padding: 16px;">
            <div style="font-weight: 600; margin-bottom: 4px;">‚úÇÔ∏è –ú–∞—Å—Ç–µ—Ä</div>
            <div style="font-size: 0.85rem; color: #6b7280;">–í—Ö–æ–¥ –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤</div>
          </button>
          <button type="button" class="btn-secondary login-type-btn" data-type="salon" style="text-align: left; padding: 16px;">
            <div style="font-weight: 600; margin-bottom: 4px;">üè¢ –°–∞–ª–æ–Ω</div>
            <div style="font-size: 0.85rem; color: #6b7280;">–í—Ö–æ–¥ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ —Å–∞–ª–æ–Ω–æ–≤</div>
          </button>
        </div>
      </div>

      <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –∫–ª–∏–µ–Ω—Ç–∞ -->
      <div id="login-client-form" style="display: none;">
        <button type="button" class="btn-secondary" id="back-login-type" style="margin-bottom: 12px; padding: 8px 16px; font-size: 0.9rem;">‚Üê –ù–∞–∑–∞–¥</button>
        <h3 style="margin-bottom: 16px;">–í—Ö–æ–¥ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞</h3>
        <form id="login-client-form-submit">
          <div>
            <label for="login-client-phone">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
            <input type="tel" id="login-client-phone" required placeholder="+998XX XXX XX XX" />
          </div>
          <div>
            <label for="login-client-password">–ü–∞—Ä–æ–ª—å (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)</label>
            <input type="password" id="login-client-password" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∏" />
          </div>
          <button type="submit" class="btn-primary" style="width: 100%; margin-top: 8px;">–í–æ–π—Ç–∏</button>
          <div id="login-client-error" class="alert alert-error" style="display: none; margin-top: 12px;"></div>
        </form>
        <p class="note" style="margin-top: 12px; text-align: center;">
          –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" id="switch-to-register-client" style="color: #a855f7;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</a>
        </p>
      </div>

      <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –º–∞—Å—Ç–µ—Ä–∞/—Å–∞–ª–æ–Ω–∞ -->
      <div id="login-owner-form" style="display: none;">
        <button type="button" class="btn-secondary" id="back-login-type-owner" style="margin-bottom: 12px; padding: 8px 16px; font-size: 0.9rem;">‚Üê –ù–∞–∑–∞–¥</button>
        <h3 style="margin-bottom: 16px;" id="login-owner-title">–í—Ö–æ–¥</h3>
        <p class="note" style="margin-bottom: 16px;">–í—ã –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞</p>
        <a href="/login" id="login-owner-link" class="btn-primary" style="width: 100%; text-align: center; text-decoration: none; display: block;">–ü–µ—Ä–µ–π—Ç–∏ –∫ –≤—Ö–æ–¥—É</a>
      </div>
    </div>
  </div>
</div>

<script>
  let currentPhone = '';
  let allBookings = [];
  let allSalons = [];
  let currentClient = null;

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞
  async function checkClientAuth() {
    try {
      const response = await fetch('/api/client');
      const result = await response.json();
      
      if (result.success && result.client) {
        currentClient = result.client;
        currentPhone = result.client.phone;
        
        // –°–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
        const phoneSection = document.getElementById('phone-input-section');
        if (phoneSection) phoneSection.style.display = 'none';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤—ã—Ö–æ–¥–∞
        const logoutLink = document.getElementById('logout-link');
        if (logoutLink) {
          logoutLink.style.display = 'block';
          logoutLink.addEventListener('click', async (e) => {
            e.preventDefault();
            await fetch('/api/logout-client', { method: 'POST' });
            window.location.reload();
          });
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
        const greeting = document.getElementById('client-greeting');
        if (greeting) {
          greeting.textContent = `–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${result.client.name}!`;
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–ø–∏—Å–∏
        await loadBookings(result.client.phone);
      } else {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
        const phoneSection = document.getElementById('phone-input-section');
        if (phoneSection) phoneSection.style.display = 'block';
        
        // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤—ã—Ö–æ–¥–∞
        const logoutLink = document.getElementById('logout-link');
        if (logoutLink) logoutLink.style.display = 'none';
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', error);
    }
  }

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  checkClientAuth();

  // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
  document.querySelectorAll('.tab').forEach(tab => {
    tab.addEventListener('click', () => {
      const tabName = tab.dataset.tab;
      
      // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
      
      // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ
      tab.classList.add('active');
      document.getElementById(`tab-${tabName}`).classList.add('active');
      
      // –ï—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏–ª–∏—Å—å –Ω–∞ —Å–∞–ª–æ–Ω—ã –∏ –æ–Ω–∏ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
      if (tabName === 'salons' && allSalons.length === 0) {
        loadSalons();
      }
    });
  });

  // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–∏—Å–µ–π –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
  document.getElementById('load-bookings-btn').addEventListener('click', async () => {
    const phoneInput = document.getElementById('client-phone-input');
    const phone = phoneInput.value.trim();
    const errorDiv = document.getElementById('phone-error');
    
    errorDiv.style.display = 'none';
    
    if (!phone) {
      errorDiv.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞';
      errorDiv.style.display = 'block';
      return;
    }
    
    const phoneDigits = phone.replace(/\D/g, '');
    if (phoneDigits.length < 9) {
      errorDiv.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–º–∏–Ω–∏–º—É–º 9 —Ü–∏—Ñ—Ä)';
      errorDiv.style.display = 'block';
      return;
    }
    
    currentPhone = phone;
    await loadBookings(phone);
  });

  // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞
  async function loadBookings(phone) {
    const bookingsList = document.getElementById('bookings-list');
    bookingsList.innerHTML = '<p style="text-align: center; color: #6b7280;">–ó–∞–≥—Ä—É–∑–∫–∞...</p>';
    
    try {
      const response = await fetch(`/api/client/bookings?phone=${encodeURIComponent(phone)}`);
      const result = await response.json();
      
      if (result.success) {
        allBookings = result.bookings || [];
        renderBookings();
      } else {
        bookingsList.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">‚ùå</div>
            <p>${result.message || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–ø–∏—Å–µ–π'}</p>
          </div>
        `;
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–ø–∏—Å–µ–π:', error);
      bookingsList.innerHTML = `
        <div class="empty-state">
          <div class="empty-state-icon">‚ùå</div>
          <p>–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</p>
        </div>
      `;
    }
  }

  // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π
  function renderBookings() {
    const bookingsList = document.getElementById('bookings-list');
    
    if (allBookings.length === 0) {
      bookingsList.innerHTML = `
        <div class="empty-state">
          <div class="empty-state-icon">üìÖ</div>
          <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π</p>
        </div>
      `;
      return;
    }
    
    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∑–∞–ø–∏—Å–∏: —Å–Ω–∞—á–∞–ª–∞ –±—É–¥—É—â–∏–µ, –ø–æ—Ç–æ–º –ø—Ä–æ—à–µ–¥—à–∏–µ
    const now = new Date();
    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    
    const sortedBookings = allBookings.sort((a, b) => {
      const dateA = new Date(a.date);
      const dateB = new Date(b.date);
      
      if (dateA.getTime() !== dateB.getTime()) {
        return dateA - dateB;
      }
      
      return a.time.localeCompare(b.time);
    });
    
    bookingsList.innerHTML = sortedBookings.map(booking => {
      const bookingDate = new Date(booking.date);
      const isPast = bookingDate < today || (bookingDate.getTime() === today.getTime() && booking.time < now.toTimeString().slice(0, 5));
      const statusClass = isPast ? 'past' : 'active';
      const statusText = isPast ? '–ü—Ä–æ—à–µ–¥—à–∞—è' : '–ê–∫—Ç–∏–≤–Ω–∞—è';
      
      const dateStr = formatDate(booking.date);
      const timeStr = formatTime(booking.time);
      
      return `
        <div class="booking-card">
          <div class="booking-header">
            <div>
              <div class="booking-service">${escapeHtml(booking.service)}</div>
              <div class="booking-date-time">üìÖ ${dateStr} –≤ ${timeStr}</div>
              ${booking.salonName ? `<div class="booking-salon">üè¢ ${escapeHtml(booking.salonName)}</div>` : ''}
              ${booking.master ? `<div class="booking-master">üë§ –ú–∞—Å—Ç–µ—Ä: ${escapeHtml(booking.master)}</div>` : ''}
              ${booking.comment ? `<div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e5e7eb; color: #6b7280; font-size: 0.9rem;">üí¨ ${escapeHtml(booking.comment)}</div>` : ''}
            </div>
            <span class="booking-status ${statusClass}">${statusText}</span>
          </div>
        </div>
      `;
    }).join('');
  }

  // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Å–∞–ª–æ–Ω–æ–≤
  async function loadSalons() {
    const salonsList = document.getElementById('salons-list');
    salonsList.innerHTML = '<p style="text-align: center; color: #6b7280;">–ó–∞–≥—Ä—É–∑–∫–∞...</p>';
    
    try {
      const response = await fetch('/api/salons');
      const result = await response.json();
      
      if (result.success) {
        allSalons = result.salons || [];
        renderSalons();
      } else {
        salonsList.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">‚ùå</div>
            <p>${result.message || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∞–ª–æ–Ω–æ–≤'}</p>
          </div>
        `;
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∞–ª–æ–Ω–æ–≤:', error);
      salonsList.innerHTML = `
        <div class="empty-state">
          <div class="empty-state-icon">‚ùå</div>
          <p>–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</p>
        </div>
      `;
    }
  }

  // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–∞–ª–æ–Ω–æ–≤
  function renderSalons() {
    const salonsList = document.getElementById('salons-list');
    
    if (allSalons.length === 0) {
      salonsList.innerHTML = `
        <div class="empty-state">
          <div class="empty-state-icon">üíá</div>
          <p>–°–∞–ª–æ–Ω–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç –≤ —Å–∏—Å—Ç–µ–º–µ</p>
        </div>
      `;
      return;
    }
    
    salonsList.innerHTML = allSalons.map(salon => {
      const salonUrl = `/booking?userId=${salon.id}`;
      return `
        <div class="salon-card" onclick="window.location.href='${salonUrl}'">
          <div class="salon-name">${escapeHtml(salon.name || '–°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã')}</div>
          ${salon.address ? `<div class="salon-address">üìç ${escapeHtml(salon.address)}</div>` : ''}
          ${salon.phone ? `<div class="salon-phone">üìû ${escapeHtml(salon.phone)}</div>` : ''}
        </div>
      `;
    }).join('');
  }

  // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
  function formatDate(dateStr) {
    const date = new Date(dateStr);
    const days = ['–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ', '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä–≥', '–ü—è—Ç–Ω–∏—Ü–∞', '–°—É–±–±–æ—Ç–∞'];
    const months = ['—è–Ω–≤–∞—Ä—è', '—Ñ–µ–≤—Ä–∞–ª—è', '–º–∞—Ä—Ç–∞', '–∞–ø—Ä–µ–ª—è', '–º–∞—è', '–∏—é–Ω—è', '–∏—é–ª—è', '–∞–≤–≥—É—Å—Ç–∞', '—Å–µ–Ω—Ç—è–±—Ä—è', '–æ–∫—Ç—è–±—Ä—è', '–Ω–æ—è–±—Ä—è', '–¥–µ–∫–∞–±—Ä—è'];
    
    const day = date.getDate();
    const month = months[date.getMonth()];
    const year = date.getFullYear();
    const dayOfWeek = days[date.getDay()];
    
    return `${day} ${month} ${year}, ${dayOfWeek}`;
  }

  function formatTime(timeStr) {
    return timeStr.slice(0, 5);
  }

  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }

  // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
  function highlightActivePage() {
    const currentPath = window.location.pathname;
    const navLinks = document.querySelectorAll('.nav-links a');
    
    navLinks.forEach(link => {
      if (link.id === 'logout-link' || link.href === '#' || !link.href) {
        return;
      }
      
      try {
        const linkPath = new URL(link.href, window.location.origin).pathname;
        const normalizedCurrent = currentPath.replace(/\/$/, '') || '/';
        const normalizedLink = linkPath.replace(/\/$/, '') || '/';
        
        if (normalizedLink === normalizedCurrent) {
          link.classList.add('active');
        } else {
          link.classList.remove('active');
        }
      } catch (e) {
        const href = link.getAttribute('href');
        if (href && (href === currentPath || href.replace(/\/$/, '') === currentPath.replace(/\/$/, ''))) {
          link.classList.add('active');
        } else {
          link.classList.remove('active');
        }
      }
    });
  }

  // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–∞–ª–æ–Ω—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  loadSalons();
  
  // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
  highlightActivePage();

  // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –≤—Ö–æ–¥–∞ (–∫–æ–ø–∏—Ä—É–µ–º –ª–æ–≥–∏–∫—É —Å –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
  // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ —É–∂–µ –µ—Å—Ç—å –≤ HTML (—Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ index.html), –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
  
  // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
  function openRegisterModal() {
    const modal = document.getElementById('register-modal');
    if (modal) {
      modal.classList.remove('hidden');
      resetRegisterModal();
    }
  }

  // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤—Ö–æ–¥–∞
  function openLoginModal() {
    const modal = document.getElementById('login-modal');
    if (modal) {
      modal.classList.remove('hidden');
      resetLoginModal();
    }
  }

  // –°–±—Ä–æ—Å –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
  function resetRegisterModal() {
    const typeSelection = document.getElementById('register-type-selection');
    const clientForm = document.getElementById('register-client-form');
    const masterForm = document.getElementById('register-master-form');
    const salonForm = document.getElementById('register-salon-form');
    const errorDiv = document.getElementById('register-client-error');
    const formSubmit = document.getElementById('register-client-form-submit');
    
    if (typeSelection) typeSelection.style.display = 'block';
    if (clientForm) clientForm.style.display = 'none';
    if (masterForm) masterForm.style.display = 'none';
    if (salonForm) salonForm.style.display = 'none';
    if (errorDiv) errorDiv.style.display = 'none';
    if (formSubmit) formSubmit.reset();
  }

  // –°–±—Ä–æ—Å –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤—Ö–æ–¥–∞
  function resetLoginModal() {
    const typeSelection = document.getElementById('login-type-selection');
    const clientForm = document.getElementById('login-client-form');
    const ownerForm = document.getElementById('login-owner-form');
    const errorDiv = document.getElementById('login-client-error');
    const formSubmit = document.getElementById('login-client-form-submit');
    
    if (typeSelection) typeSelection.style.display = 'block';
    if (clientForm) clientForm.style.display = 'none';
    if (ownerForm) ownerForm.style.display = 'none';
    if (errorDiv) errorDiv.style.display = 'none';
    if (formSubmit) formSubmit.reset();
  }

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
  document.getElementById('open-cabinet-register-modal')?.addEventListener('click', openRegisterModal);
  document.getElementById('open-cabinet-login-modal')?.addEventListener('click', openLoginModal);

  // –ö–Ω–æ–ø–∫–∞ –ø–æ–∫–∞–∑–∞ —Ñ–æ—Ä–º—ã –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
  document.getElementById('load-bookings-by-phone-btn')?.addEventListener('click', () => {
    const phoneForm = document.getElementById('phone-input-form');
    if (phoneForm) {
      phoneForm.style.display = 'block';
    }
  });

  // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
  document.getElementById('close-register-modal')?.addEventListener('click', () => {
    document.getElementById('register-modal')?.classList.add('hidden');
  });
  document.getElementById('close-login-modal')?.addEventListener('click', () => {
    document.getElementById('login-modal')?.classList.add('hidden');
  });

  // –ö–ª–∏–∫ –ø–æ —Ñ–æ–Ω—É –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
  document.getElementById('register-modal')?.addEventListener('click', (e) => {
    if (e.target.id === 'register-modal') {
      document.getElementById('register-modal').classList.add('hidden');
    }
  });
  document.getElementById('login-modal')?.addEventListener('click', (e) => {
    if (e.target.id === 'login-modal') {
      document.getElementById('login-modal').classList.add('hidden');
    }
  });

  // –í—ã–±–æ—Ä —Ç–∏–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
  document.querySelectorAll('.register-type-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const type = btn.dataset.type;
      const typeSelection = document.getElementById('register-type-selection');
      if (typeSelection) typeSelection.style.display = 'none';
      
      if (type === 'client') {
        const form = document.getElementById('register-client-form');
        if (form) form.style.display = 'block';
      } else if (type === 'master') {
        const form = document.getElementById('register-master-form');
        if (form) form.style.display = 'block';
      } else if (type === 'salon') {
        const form = document.getElementById('register-salon-form');
        if (form) form.style.display = 'block';
      }
    });
  });

  // –í—ã–±–æ—Ä —Ç–∏–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –≤—Ö–æ–¥–∞
  document.querySelectorAll('.login-type-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const type = btn.dataset.type;
      const typeSelection = document.getElementById('login-type-selection');
      if (typeSelection) typeSelection.style.display = 'none';
      
      if (type === 'client') {
        const form = document.getElementById('login-client-form');
        if (form) form.style.display = 'block';
      } else {
        const form = document.getElementById('login-owner-form');
        const title = document.getElementById('login-owner-title');
        const link = document.getElementById('login-owner-link');
        if (form) form.style.display = 'block';
        if (type === 'master' && title) {
          title.textContent = '–í—Ö–æ–¥ –¥–ª—è –º–∞—Å—Ç–µ—Ä–∞';
        } else if (type === 'salon' && title) {
          title.textContent = '–í—Ö–æ–¥ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Å–∞–ª–æ–Ω–∞';
        }
        if (link) link.href = '/login';
      }
    });
  });

  // –ö–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
  document.getElementById('back-register-type')?.addEventListener('click', resetRegisterModal);
  document.getElementById('back-register-type-master')?.addEventListener('click', resetRegisterModal);
  document.getElementById('back-register-type-salon')?.addEventListener('click', resetRegisterModal);

  // –ö–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" –¥–ª—è –≤—Ö–æ–¥–∞
  document.getElementById('back-login-type')?.addEventListener('click', resetLoginModal);
  document.getElementById('back-login-type-owner')?.addEventListener('click', resetLoginModal);

  // –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞ (–µ—Å–ª–∏ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –µ—Å—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
  const registerClientForm = document.getElementById('register-client-form-submit');
  if (registerClientForm) {
    registerClientForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const errorDiv = document.getElementById('register-client-error');
      if (errorDiv) errorDiv.style.display = 'none';

      const data = {
        name: document.getElementById('reg-client-name').value.trim(),
        phone: document.getElementById('reg-client-phone').value.trim(),
        email: document.getElementById('reg-client-email').value.trim(),
        password: document.getElementById('reg-client-password').value
      };

      if (!data.name || data.name.length < 2) {
        if (errorDiv) {
          errorDiv.textContent = '–ò–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞';
          errorDiv.style.display = 'block';
        }
        return;
      }

      const phoneDigits = data.phone.replace(/\D/g, '');
      if (phoneDigits.length < 9) {
        if (errorDiv) {
          errorDiv.textContent = '–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞';
          errorDiv.style.display = 'block';
        }
        return;
      }

      if (data.password && data.password.length < 6) {
        if (errorDiv) {
          errorDiv.textContent = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤';
          errorDiv.style.display = 'block';
        }
        return;
      }

      try {
        const response = await fetch('/api/register-client', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        const result = await response.json();
        if (result.success) {
          window.location.reload();
        } else {
          if (errorDiv) {
            errorDiv.textContent = result.message || '–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏';
            errorDiv.style.display = 'block';
          }
        }
      } catch (error) {
        if (errorDiv) {
          errorDiv.textContent = '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.';
          errorDiv.style.display = 'block';
        }
      }
    });
  }

  // –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –∫–ª–∏–µ–Ω—Ç–∞ (–µ—Å–ª–∏ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –µ—Å—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
  const loginClientForm = document.getElementById('login-client-form-submit');
  if (loginClientForm) {
    loginClientForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const errorDiv = document.getElementById('login-client-error');
      if (errorDiv) errorDiv.style.display = 'none';

      const data = {
        phone: document.getElementById('login-client-phone').value.trim(),
        password: document.getElementById('login-client-password').value
      };

      const phoneDigits = data.phone.replace(/\D/g, '');
      if (phoneDigits.length < 9) {
        if (errorDiv) {
          errorDiv.textContent = '–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞';
          errorDiv.style.display = 'block';
        }
        return;
      }

      try {
        const response = await fetch('/api/login-client', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        const result = await response.json();
        if (result.success) {
          window.location.reload();
        } else {
          if (errorDiv) {
            errorDiv.textContent = result.message || '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞';
            errorDiv.style.display = 'block';
          }
        }
      } catch (error) {
        if (errorDiv) {
          errorDiv.textContent = '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.';
          errorDiv.style.display = 'block';
        }
      }
    });
  }

  // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π –∏ –≤—Ö–æ–¥–æ–º
  document.getElementById('switch-to-register-client')?.addEventListener('click', (e) => {
    e.preventDefault();
    document.getElementById('login-modal')?.classList.add('hidden');
    openRegisterModal();
    setTimeout(() => {
      const clientBtn = document.querySelector('.register-type-btn[data-type="client"]');
      if (clientBtn) clientBtn.click();
    }, 100);
  });
</script>
</body>
</html>

